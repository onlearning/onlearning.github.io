import{_ as n,c as a,a2 as p,o as l}from"./chunks/framework.DPuwY6B9.js";const y=JSON.parse('{"title":"小程序基础","description":"","frontmatter":{},"headers":[],"relativePath":"src/base/小程序基础.md","filePath":"src/base/小程序基础.md","lastUpdated":1713863841000}'),e={name:"src/base/小程序基础.md"};function o(t,s,r,c,i,d){return l(),a("div",null,s[0]||(s[0]=[p(`<h1 id="小程序基础" tabindex="-1">小程序基础 <a class="header-anchor" href="#小程序基础" aria-label="Permalink to &quot;小程序基础&quot;">​</a></h1><h2 id="基本组成结构" tabindex="-1">基本组成结构 <a class="header-anchor" href="#基本组成结构" aria-label="Permalink to &quot;基本组成结构&quot;">​</a></h2><p>pages 文件夹 用来存放所有小程序的页面</p><p>utils 文件夹 用来存放工具性质的模块（例如：格式化时间的自定义模块）</p><p>app.js 小程序项目的入口文件</p><p>app.json 小程序项目的全局配置文件</p><p>app.wxss 小程序项目的全局样式文件</p><p>project.config.json 项目的配置文件</p><p>sitemap.json 用来配置小程序及其页面是否允许被微信索引</p><h3 id="app-js" tabindex="-1">app.js <a class="header-anchor" href="#app-js" aria-label="Permalink to &quot;app.js&quot;">​</a></h3><p>是整个小程序项目的入口文件，通过调用 App() 函数来启动整个小程序</p><h3 id="app-json" tabindex="-1">app.json <a class="header-anchor" href="#app-json" aria-label="Permalink to &quot;app.json&quot;">​</a></h3><p>pages：用来记录当前小程序所有页面的路径</p><p>window：全局定义小程序所有页面的背景色、文字颜色等</p><p>style：全局定义小程序组件所使用的样式版本，删除该行可改变样式</p><p>sitemapLocation：用来指明 sitemap.json 的位置</p><p>小程序会自动将排在 pages 第一位的页面当做首页进行渲染</p><p>如果在 app.json-&gt;pages 内新增应新页面的存放路径，则系统会为新页面自动创建文件夹</p><p>注意：每个页面也有单独的 json 文件，页面的 json 文件配置优先级高于全局的 app.json</p><h3 id="sitemap-json" tabindex="-1">sitemap.json <a class="header-anchor" href="#sitemap-json" aria-label="Permalink to &quot;sitemap.json&quot;">​</a></h3><p>sitemap 的索引提示是默认开启的，如需要关闭 sitemap 的索引提示，可在小程序项目配置文件</p><p>project.config.json 的 setting 中配置字段 checkSiteMap 为 false</p><h3 id="pages-文件夹" tabindex="-1">pages 文件夹 <a class="header-anchor" href="#pages-文件夹" aria-label="Permalink to &quot;pages 文件夹&quot;">​</a></h3><p>用于存放页面，每个页面都作为一个单独的文件夹存在</p><p>其中，每个页面由 4 个基本文件组成，它们分别是：</p><p>1、.js 文件（页面的脚本文件，存放页面的数据、事件处理函数等）</p><p>2、.json 文件（当前页面的配置文件，配置窗口的外观、表现等）</p><p>3、.wxml 文件（页面的模板结构文件）</p><p>4、.wxss 文件（当前页面的样式表文件）</p><h3 id="wxml" tabindex="-1">WXML <a class="header-anchor" href="#wxml" aria-label="Permalink to &quot;WXML&quot;">​</a></h3><p>类似于网页开发中的 html，区别在于</p><p>1、标签名称不同</p><p>HTML （div, span, img, a）</p><p>WXML（view, text, image, navigator）</p><p>2、属性节点不同</p><p>html 中使用 a 标签进行跳转 <code>&lt;a href=&quot;&quot;&gt;</code></p><p>wxml 中使用 navigator 标签进行跳转 <code>&lt;navigator url=&quot;/pages/home/home&quot;&gt;&lt;/navigator&gt;</code></p><p>3、wxml 提供了类似于 Vue 中的模板语法</p><p>数据绑定</p><p>列表渲染</p><p>条件渲染</p><h3 id="wxss" tabindex="-1">WXSS <a class="header-anchor" href="#wxss" aria-label="Permalink to &quot;WXSS&quot;">​</a></h3><p>类似于网页开发中的 css，区别在于</p><p>1、新增了 rpx 尺寸单位</p><p>CSS 中需要手动进行像素单位换算，例如 rem</p><p>WXSS 在底层支持新的尺寸单位 rpx，在不同大小的屏幕上小程序会自动进行换算</p><p>2、提供了全局的样式和局部样式</p><p>项目根目录中的 app.wxss 会作用于所有小程序页面</p><p>但局部页面的 .wxss 样式仅对当前页面生效</p><p>3、WXSS 仅支持部分 CSS 选择器，以下为支持的选择器</p><p>.class 和 #id</p><p>element</p><p>并集选择器、后代选择器</p><p><code>::after</code> 和 <code>::before</code> 等伪类选择器</p><h2 id="组件" tabindex="-1">组件 <a class="header-anchor" href="#组件" aria-label="Permalink to &quot;组件&quot;">​</a></h2><h3 id="view" tabindex="-1">view <a class="header-anchor" href="#view" aria-label="Permalink to &quot;view&quot;">​</a></h3><p>类似 html 中的 div，为一个块级元素</p><h3 id="scroll-view" tabindex="-1">scroll-view <a class="header-anchor" href="#scroll-view" aria-label="Permalink to &quot;scroll-view&quot;">​</a></h3><p>可滚动的视图区，常用语实现滚动列表</p><p>自带属性：（使用 scroll-y 时需要给 scroll-view 一个固定高度）</p><p>scroll-y 允许纵向滚动</p><p>scroll-x 允许横向滚动</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">scroll-view</span><span style="color:#6F42C1;"> class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;container1&quot;</span><span style="color:#6F42C1;"> scroll-y</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;A&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;B&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;C&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#005CC5;">scroll-view</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="swiper" tabindex="-1">swiper <a class="header-anchor" href="#swiper" aria-label="Permalink to &quot;swiper&quot;">​</a></h3><p>轮播图容器，子组件为 swiper-item</p><p>自带属性：</p><table tabindex="0"><thead><tr><th style="text-align:center;">属性</th><th style="text-align:center;">类型</th><th style="text-align:center;">值</th><th style="text-align:center;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">indicator-dots</td><td style="text-align:center;">boolean</td><td style="text-align:center;">false</td><td style="text-align:center;">是否显示面板指示点</td></tr><tr><td style="text-align:center;">indicator-color</td><td style="text-align:center;">color</td><td style="text-align:center;">rgba(0, 0, 0, .3)</td><td style="text-align:center;">指示点颜色</td></tr><tr><td style="text-align:center;">indicator-active-color</td><td style="text-align:center;">color</td><td style="text-align:center;">#000</td><td style="text-align:center;">选中的指示点颜色</td></tr><tr><td style="text-align:center;">autoplay</td><td style="text-align:center;">boolean</td><td style="text-align:center;">false</td><td style="text-align:center;">是否自动播放</td></tr><tr><td style="text-align:center;">interval</td><td style="text-align:center;">number</td><td style="text-align:center;">5000（毫秒）</td><td style="text-align:center;">自动播放切换时间间隔</td></tr><tr><td style="text-align:center;">circular</td><td style="text-align:center;">boolean</td><td style="text-align:center;">false</td><td style="text-align:center;">衔接滚动（最后一张和第一张衔接）</td></tr></tbody></table><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">swiper</span><span style="color:#6F42C1;"> class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;container2&quot;</span><span style="color:#6F42C1;"> indicator-dots</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#005CC5;">swiper-item</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">view</span><span style="color:#6F42C1;"> class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;item&quot;</span><span style="color:#24292E;">&gt;1&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#005CC5;">swiper-item</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#005CC5;">swiper-item</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">view</span><span style="color:#6F42C1;"> class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;item&quot;</span><span style="color:#24292E;">&gt;2&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#005CC5;">swiper-item</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#005CC5;">swiper-item</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">view</span><span style="color:#6F42C1;"> class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;item&quot;</span><span style="color:#24292E;">&gt;3&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#005CC5;">swiper-item</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#005CC5;">swiper-item</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">view</span><span style="color:#6F42C1;"> class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;item&quot;</span><span style="color:#24292E;">&gt;4&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#005CC5;">swiper-item</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">swiper</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="text" tabindex="-1">text <a class="header-anchor" href="#text" aria-label="Permalink to &quot;text&quot;">​</a></h3><p>普通的文本组件，类似 span，为行内元素</p><p>通过设置 selectable 可以设置长按选中效果</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">text</span><span style="color:#6F42C1;"> selectable</span><span style="color:#24292E;">&gt;51484884&lt;/</span><span style="color:#22863A;">text</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="rich-text" tabindex="-1">rich-text <a class="header-anchor" href="#rich-text" aria-label="Permalink to &quot;rich-text&quot;">​</a></h3><p>富文本组件，支持把 HTML 字符串渲染为 WXML 结构</p><p><code>&lt;rich-text nodes=&quot;&lt;h1&gt;标题&lt;/h1&gt;&quot;&gt;&lt;/rich-text&gt;</code></p><h3 id="button" tabindex="-1">button <a class="header-anchor" href="#button" aria-label="Permalink to &quot;button&quot;">​</a></h3><p>按钮组件，但比 html 中的 button 按钮功能丰富</p><p>通过 open-type 属性可以调用微信提供的各种功能（客服、转发、获取用户授权等）</p><p>type primary 主色调为绿色的按钮 warn 警告按钮</p><p>size mini 小尺寸按钮</p><p>添加 plain 属性可变为无背景色的镂空按钮</p><h3 id="image" tabindex="-1">image <a class="header-anchor" href="#image" aria-label="Permalink to &quot;image&quot;">​</a></h3><p>图片组件，默认宽为 300px，高为 240px，可以通过 mode 属性控制图片缩放</p><table tabindex="0"><thead><tr><th style="text-align:center;">mode</th><th style="text-align:center;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">scaleToFill</td><td style="text-align:center;">（默认值）缩放模式，不保持纵横比缩放图片，使图片的宽高完全拉伸至填满 image 元素</td></tr><tr><td style="text-align:center;">aspectFit</td><td style="text-align:center;">缩放模式，保持纵横比缩放图片，使图片的长边能完全显示出来。也就是说，可以完整地将图片显示出来，但图片区域填不满会有留白</td></tr><tr><td style="text-align:center;">aspectFill</td><td style="text-align:center;">缩放模式，保持纵横比缩放图片，只保证图片的短边能完全显示出来。也就是说，图片区域会被填满但原图会被裁剪</td></tr><tr><td style="text-align:center;">widthFix</td><td style="text-align:center;">缩放模式，宽度不变，高度自动变化，保持原图宽高比不变</td></tr><tr><td style="text-align:center;">heightFix</td><td style="text-align:center;">缩放模式，宽度不变，高度自动变化，保持原图宽高比不变</td></tr></tbody></table><h3 id="navigator" tabindex="-1">navigator <a class="header-anchor" href="#navigator" aria-label="Permalink to &quot;navigator&quot;">​</a></h3><p>导航组件，类似 a 链接 <code>&lt;navigator url=&quot;/pages/home/home&quot;&gt;&lt;/navigator&gt;</code></p><h2 id="api" tabindex="-1">API <a class="header-anchor" href="#api" aria-label="Permalink to &quot;API&quot;">​</a></h2><h3 id="事件监听类-api" tabindex="-1">事件监听类 API <a class="header-anchor" href="#事件监听类-api" aria-label="Permalink to &quot;事件监听类 API&quot;">​</a></h3><p>特点：以 on 开头，用来监听某些事件的触发</p><p>举例：<code>wx.onWindowResize(function callback)</code> 监听窗口尺寸变化的事件</p><h3 id="同步-api" tabindex="-1">同步 API <a class="header-anchor" href="#同步-api" aria-label="Permalink to &quot;同步 API&quot;">​</a></h3><p>1、以 Sync 结尾的 API 都是同步 API</p><p>2、同步 API 的执行结果，可以通过函数返回值直接获取，如果执行出错会抛出异常</p><p>举例：<code>wx.setStorageSync(&#39;key&#39;, &#39;value&#39;)</code> 向本地存储中写入内容</p><h3 id="异步-api" tabindex="-1">异步 API <a class="header-anchor" href="#异步-api" aria-label="Permalink to &quot;异步 API&quot;">​</a></h3><p>特点：类似于 jQuery 中的 $.ajax(options) 函数，需要通过 success、fail、complete 接收调用的结果</p><p>举例：<code>wx.request()</code> 发起网络数据请求，通过 success 回调函数接收数据</p><h2 id="事件及数据" tabindex="-1">事件及数据 <a class="header-anchor" href="#事件及数据" aria-label="Permalink to &quot;事件及数据&quot;">​</a></h2><h3 id="数据绑定" tabindex="-1">数据绑定 <a class="header-anchor" href="#数据绑定" aria-label="Permalink to &quot;数据绑定&quot;">​</a></h3><p>在 data 中定义数据，在页面对应的 js 文件中将数据定义在 data 内</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">page</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  data: {</span></span>
<span class="line"><span style="color:#24292E;">    msg: </span><span style="color:#032F62;">&#39;这是一条 msg&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    magList: [{ mag: </span><span style="color:#032F62;">&#39;hello&#39;</span><span style="color:#24292E;"> }, { msg: </span><span style="color:#032F62;">&#39;world&#39;</span><span style="color:#24292E;"> }]</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>在 wxml 中使用数据，以插值表达式展示数据</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#005CC5;"> msg</span><span style="color:#D73A49;"> =</span><span style="color:#032F62;"> &#39;数据&#39;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;{{msg}}&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>动态绑定属性同样使用插值表达式</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#005CC5;"> imgsrc</span><span style="color:#D73A49;"> =</span><span style="color:#032F62;"> &#39;xxxx&#39;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">image</span><span style="color:#6F42C1;"> src</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{{imgsrc}}&gt;&lt;/</span><span style="color:#22863A;">image</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>同时可以在插值表达式中使用三元表达式和进行一些简单的计算</p><h3 id="事件绑定" tabindex="-1">事件绑定 <a class="header-anchor" href="#事件绑定" aria-label="Permalink to &quot;事件绑定&quot;">​</a></h3><p>tap 事件 手指触摸事件，类似 click 事件 常用 <code>bindtap</code> 或 <code>bind:tap</code></p><p>input 事件 文本框输入事件 常用 <code>bindinput</code> 或 <code>bind:input</code></p><p>change 事件 状态改变时触发的事件 常用 <code>bindchange</code> 或 <code>bind:change</code></p><p>事件回调会接收到事件 event 比如 <code>event.target</code></p><table tabindex="0"><thead><tr><th style="text-align:center;">属性</th><th style="text-align:center;">类型</th><th style="text-align:center;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">type</td><td style="text-align:center;">string</td><td style="text-align:center;">返回的事件类型</td></tr><tr><td style="text-align:center;">timestamp</td><td style="text-align:center;">integer</td><td style="text-align:center;">页面打开到触发事件所经过的毫秒数</td></tr><tr><td style="text-align:center;">target</td><td style="text-align:center;">object</td><td style="text-align:center;">触发事件的组件的属性值集合</td></tr><tr><td style="text-align:center;">currentTarget</td><td style="text-align:center;">object</td><td style="text-align:center;">当前组件的属性值集合</td></tr><tr><td style="text-align:center;">detail</td><td style="text-align:center;">object</td><td style="text-align:center;">额外的信息</td></tr><tr><td style="text-align:center;">touches</td><td style="text-align:center;">Array</td><td style="text-align:center;">触摸事件，当前停留在屏幕中的触摸点信息的数组，比如有几个手指触摸</td></tr><tr><td style="text-align:center;">changedTouches</td><td style="text-align:center;">Array</td><td style="text-align:center;">触摸事件，当前变化的触摸点信息的数组</td></tr></tbody></table><p><strong>target 和 eventTarget 的区别</strong></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">view</span><span style="color:#6F42C1;"> class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;eveTest&quot;</span><span style="color:#6F42C1;"> bindtap</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;onHandle&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;123&lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>点击内部的按钮时，点击事件以冒泡的方式向外扩散，也会触发外层 view 的 tap 事件处理函数。</p><p>此时，对于外层的 view 来说：</p><p>e.target 指向的是触发事件的源头组件，因此，e.target 是内部的按钮组件</p><p>e.currentTarget 指向的是当前正在触发事件的那个组件，因此，e.currentTarget 是当前的 view 组件</p><h3 id="事件传参" tabindex="-1">事件传参 <a class="header-anchor" href="#事件传参" aria-label="Permalink to &quot;事件传参&quot;">​</a></h3><p>小程序不能在绑定事件同时传参，需要通过 <code>data-*</code>自定义属性传参</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">button</span><span style="color:#6F42C1;"> bindtap</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;btnclick&quot;</span><span style="color:#6F42C1;"> data-info</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;{{2}}&quot;</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>info 是参数名，2 是参数值</p><p>在 event.target.dataset.info 可获取到参数值</p><p>可通过 bindinput 搭配 e.detail.value 获取输入框的最新值</p><p>通过 this.setData 可重新设置输入框内的数据值</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#005CC5;">this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">setData</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  msg: e.detail.value</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="条件渲染" tabindex="-1">条件渲染 <a class="header-anchor" href="#条件渲染" aria-label="Permalink to &quot;条件渲染&quot;">​</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">wx</span><span style="color:#24292E;">:</span><span style="color:#D73A49;">if=</span><span style="color:#24292E;">{{语句}}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>如果语句返回的 Boolean 是 true 则渲染，反之则不渲染，可搭配<code>wx:elif</code>和<code>wx:else</code> 进行判断渲染</p><p>如果需要一次性控制多个组件的显示与隐藏，只需要在外层包裹一个<code>&lt;block&gt;</code>它并非一个真实的组件，只是一个容器</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">hidden</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{{语句}}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>hidden 也可以控制组件的显示或隐藏，为 true 则隐藏，否则显示</p><p><code>wx:if</code> 类似 <code>v-if </code>会动态的移除和创建元素，适用于控制条件复杂时</p><p><code>hidden</code> 类似 <code>v-show</code> 只切换元素的 display 控制显示和隐藏，适用于频繁切换</p><h3 id="列表渲染" tabindex="-1">列表渲染 <a class="header-anchor" href="#列表渲染" aria-label="Permalink to &quot;列表渲染&quot;">​</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">wx</span><span style="color:#24292E;">:for</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{{array}}</span></span>
<span class="line"><span style="color:#6A737D;">// 可将数组的每一项渲染出来</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">view</span><span style="color:#6F42C1;"> wx</span><span style="color:#24292E;">:</span><span style="color:#6F42C1;">for</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;{{array}}&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  索引是{{index}}当前项是{{item}}</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;">// 可以使用wx:for-index指定自定义的索引变量名字，使用wx:for-item指定当前项的变量名,避免命名冲突</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">view</span><span style="color:#6F42C1;"> wx</span><span style="color:#24292E;">:</span><span style="color:#6F42C1;">for</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;{{array}}&quot;</span><span style="color:#6F42C1;"> wx</span><span style="color:#24292E;">:</span><span style="color:#6F42C1;">for-index</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;i&quot;</span><span style="color:#6F42C1;"> wx</span><span style="color:#24292E;">:</span><span style="color:#6F42C1;">for-item</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;t&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  索引是{{i}}当前项是{{t}}</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;">// wx:key类似于列表的唯一key，可提高渲染效率</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="wxss-模板样式" tabindex="-1">WXSS 模板样式 <a class="header-anchor" href="#wxss-模板样式" aria-label="Permalink to &quot;WXSS 模板样式&quot;">​</a></h3><p>rpx 是微信小程序中独有的为不同屏幕提供的适配单位,将屏幕总宽度 分为 750 份，即 750rpx</p><p>样式导入 在自己文件的 wxss 中可以使用@import 导入外部样式表的相对路径</p><p>局部样式只能作用于当前页面，全局样式作用于所有页面，如果存在样式冲突将以局部样式为主</p><h2 id="全局配置" tabindex="-1">全局配置 <a class="header-anchor" href="#全局配置" aria-label="Permalink to &quot;全局配置&quot;">​</a></h2><p>pages 存放小程序所有页面的路径</p><p>window 设置小程序的窗口外观</p><p>tabBar 设置小程序底部的 tabBar 效果</p><p>style 是否启用新版组件样式</p><h3 id="window" tabindex="-1">window <a class="header-anchor" href="#window" aria-label="Permalink to &quot;window&quot;">​</a></h3><p>分为三个区域分别是</p><p>头部及其以上的导航栏区域 navigationBar</p><p>背景区域即下拉可见区 background</p><h3 id="页面主体区-wxml" tabindex="-1">页面主体区 wxml <a class="header-anchor" href="#页面主体区-wxml" aria-label="Permalink to &quot;页面主体区 wxml&quot;">​</a></h3><p>navigationBarTitleText 设置导航栏标题文本</p><p>navigationBarBackgroundColor 设置导航栏的背景色</p><p>navigationBarTextStyle 设置导航栏的标题文本颜色 仅支持 black/white</p><p>enablePullDownRefresh 设置为 true 开启下拉刷新</p><p>backgroundColor 设置下拉的背景色</p><p>backgroundTextStyle 设置下拉的小圆点背景色 只能是 dark 或 light</p><p>onReachBottomDistance 设置上拉触底的距离，默认为 50px</p><h3 id="tabbar" tabindex="-1">tabBar <a class="header-anchor" href="#tabbar" aria-label="Permalink to &quot;tabBar&quot;">​</a></h3><p>用于页面切换，分为底部 tabBar 和顶部 tabBar</p><p>最多只能有 5 个，最好 2 个且为顶部 tabBar 时不渲染 icon</p><p>backgroundColor tabBar 的背景色</p><p>selectedIconPath 选中的图片路径</p><p>BorderStyle tabBar 上边框的颜色</p><p>iconPath 未选中的图片路径</p><p>selectedColor 选中的 tab 的文字颜色</p><p>color 未选中的 tab 的文字颜色</p><p>position tabBar 位置 仅支持 top/bottom</p><p>BorderStyle 上边框颜色 仅支持 black/white</p><p>list tab 页列表最少 2 个 最多 5 个</p><h3 id="页面配置" tabindex="-1">页面配置 <a class="header-anchor" href="#页面配置" aria-label="Permalink to &quot;页面配置&quot;">​</a></h3><p>每个页面都有自己的 json 文件，页面配置会覆盖全局配置，可以让页面有独立的外观，可以单独为页面开启下拉刷新</p><h3 id="页面事件" tabindex="-1">页面事件 <a class="header-anchor" href="#页面事件" aria-label="Permalink to &quot;页面事件&quot;">​</a></h3><p>1、下拉刷新</p><p>在页面的.json 内添加对象<code>enablePullDownRefresh</code>开启</p><p>在页面.js 文件的<code>onPullDownRefresh</code>内监听用户下拉刷新</p><p>下拉刷新不会自动关闭，需要手动调用<code>wx.stopPullDownRefresh()</code>在数据处理完关闭下拉刷新</p><p>2、上拉触底</p><p>在页面.js 文件的<code>onReachBottom</code>内监听用户上拉触底，一般用来发起请求，为了防止用户重复发起请求，需要对请求进行节流操作</p><p>在请求时一般需要添加 loading 提示效果</p><p>调用 <code>wx.showLoading</code> 开启提示</p><p>调用 <code>wx.hideLoading</code> 关闭提示</p><p><strong>节流</strong></p><p>在 data 内定义一个 isloading 判断请求是否在发送</p><p>完成请求时修改此值</p><div class="language-JS line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">JS</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">getColor</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#6A737D;">  // 节流</span></span>
<span class="line"><span style="color:#005CC5;">  this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">setData</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    isLoading: </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"><span style="color:#6A737D;">  // 展示 Loading</span></span>
<span class="line"><span style="color:#24292E;">  wx.</span><span style="color:#6F42C1;">showLoading</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    title: </span><span style="color:#032F62;">&#39;加载中&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"><span style="color:#24292E;">  wx.</span><span style="color:#6F42C1;">request</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    url: </span><span style="color:#032F62;">&#39;https://www.escook.cn/api/color&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    method: </span><span style="color:#032F62;">&#39;GET&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#6F42C1;">    success</span><span style="color:#24292E;">: ({</span><span style="color:#E36209;">data</span><span style="color:#24292E;">: </span><span style="color:#E36209;">res</span><span style="color:#24292E;">}) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#005CC5;">      this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">setData</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">        colorList: [</span><span style="color:#D73A49;">...</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.data.colorList, </span><span style="color:#D73A49;">...</span><span style="color:#24292E;">res.data]</span></span>
<span class="line"><span style="color:#24292E;">      })</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#6F42C1;">    complete</span><span style="color:#24292E;">: () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">      wx.</span><span style="color:#6F42C1;">hideLoading</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#6A737D;">      // 关闭节流</span></span>
<span class="line"><span style="color:#005CC5;">      this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">setData</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">        isLoading: </span><span style="color:#005CC5;">false</span></span>
<span class="line"><span style="color:#24292E;">      })</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="页面导航" tabindex="-1">页面导航 <a class="header-anchor" href="#页面导航" aria-label="Permalink to &quot;页面导航&quot;">​</a></h3><p>1、声明式导航</p><p>在页面声明一个 navigation 导航组件，类似 a 标签，用户点击跳转页面</p><p>2、前进导航</p><p>需要指定 url 和 open-type 属性</p><p>url 是页面的路由</p><p>open-type 是 swichTab 则跳转至 tabBar 页面</p><p>open-type 是 navigate 或不填则跳转至非 tabBar 页面</p><p>跳转到 tabBar 页面调用 wx.switchTab()方法</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">gotoUrl</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  wx.</span><span style="color:#6F42C1;">switchTab</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    url:</span><span style="color:#032F62;">&#39;/pages/index/index&#39;</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>跳转至非 tabBar 页面调用 wx.navigateTo()方法</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">gotoUrl</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  wx.</span><span style="color:#6F42C1;">navigateTo</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    url:</span><span style="color:#032F62;">&#39;/pages/index/index&#39;</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>导航传参</strong></p><p>在 url 后面使用?传参，多个参数使用&amp;符连接<code>url=&quot;/pages/index/index?id=1&amp;br=2&quot;</code></p><p><strong>接收参数</strong></p><p>在目标页面的 onload 生命周期可以通过 options 参数接收</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">onload</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">function</span><span style="color:#24292E;">(</span><span style="color:#E36209;">options</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#005CC5;">  this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">setDate</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    query: options</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>3、 后退导航</p><p>需要指定 open-type 属性为 navigateBack，delta 为后退的层级，填入数字，如果只后退回上一页则可以不填</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">goBack</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  wx.</span><span style="color:#6F42C1;">navigateBack</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    delta: </span><span style="color:#005CC5;">2</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="网络请求" tabindex="-1">网络请求 <a class="header-anchor" href="#网络请求" aria-label="Permalink to &quot;网络请求&quot;">​</a></h2><p>1、只能请求 Https 类型的接口</p><p>2、必须将接口的域名添加到信任列表中</p><p>使用 <code>wx.request()</code>发起 get 或 post 请求</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">wx.</span><span style="color:#6F42C1;">request</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  url:</span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#24292E;">,请求的地址</span></span>
<span class="line"><span style="color:#24292E;">  method:</span><span style="color:#032F62;">&quot;get/post&quot;</span><span style="color:#24292E;">,</span><span style="color:#6A737D;">//请求的方式</span></span>
<span class="line"><span style="color:#24292E;">  data:{},</span><span style="color:#6A737D;">// 发送到服务器的数据</span></span>
<span class="line"><span style="color:#24292E;">  success: (</span><span style="color:#E36209;">res</span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#6A737D;">    //请求成功的回调</span></span>
<span class="line"><span style="color:#24292E;">    })</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>如果需要页面刚加载时需要获取初始化数据，在小程序的 onLoad 事件内进行函数调用发起请求</p><p>小程序中不存在跨域的问题</p><p>请求注意节流，同时要注意有多少条数据防止发送额外请求，参考本文页面事件中的上拉触底</p><h3 id="promise-化" tabindex="-1">promise 化 <a class="header-anchor" href="#promise-化" aria-label="Permalink to &quot;promise 化&quot;">​</a></h3><p>依赖于 <code>miniprogram-api-promise@1.0.4</code>,需要使用 npm 安装</p><p>在 app.js 中使用 <code>promisifyAll()</code>方法</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> {promisifyAll} </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> ’miniprogram-api-promise‘</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#005CC5;"> wxp</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> wx.p </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {}</span></span>
<span class="line"><span style="color:#6F42C1;">promisifyAll</span><span style="color:#24292E;">(wx, wxp)</span></span>
<span class="line"><span style="color:#6A737D;">// 在请求时</span></span>
<span class="line"><span style="color:#24292E;">async </span><span style="color:#6F42C1;">getInfo</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#D73A49;">  const</span><span style="color:#24292E;"> {</span><span style="color:#E36209;">data</span><span style="color:#24292E;"> :</span><span style="color:#005CC5;">res</span><span style="color:#24292E;">} </span><span style="color:#D73A49;">=</span><span style="color:#D73A49;"> await</span><span style="color:#24292E;"> wx.p.</span><span style="color:#6F42C1;">requsest</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    method: </span><span style="color:#032F62;">&#39;GET&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    url: </span><span style="color:#032F62;">&#39;https://www.esscook.cn/api/get&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    data: { name: </span><span style="color:#032F62;">&#39;zs&#39;</span><span style="color:#24292E;"> }</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"><span style="color:#24292E;">  console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(res)</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="生命周期" tabindex="-1">生命周期 <a class="header-anchor" href="#生命周期" aria-label="Permalink to &quot;生命周期&quot;">​</a></h2><h3 id="应用生命周期" tabindex="-1">应用生命周期 <a class="header-anchor" href="#应用生命周期" aria-label="Permalink to &quot;应用生命周期&quot;">​</a></h3><p>应用生命周期函数有三个 ----app.js</p><p>onlaunch ----当小程序初始化完成时，会触发 onLaunch（全局只触发一次）</p><p>onShow -----当小程序启动，或从后台进入前台显示，会触发 onShow</p><p>onHide -----当小程序从前台进入后台，会触发 onHide</p><h3 id="页面生命周期" tabindex="-1">页面生命周期 <a class="header-anchor" href="#页面生命周期" aria-label="Permalink to &quot;页面生命周期&quot;">​</a></h3><p>页面声明周期有五个 ----页面的 js 文件</p><p>onLoad ----监听页面加载，一个页面调用一次</p><p>onReady ----页面初次渲染完成，一个页面调用一次，可以控制页面结构，修改页面内容</p><p>onUnload ----页面卸载，一个页面调用一次</p><p>onShow ---- 监听页面显示</p><p>onHide ----监听页面隐藏</p><h3 id="wxs-脚本" tabindex="-1">WXS 脚本 <a class="header-anchor" href="#wxs-脚本" aria-label="Permalink to &quot;WXS 脚本&quot;">​</a></h3><p>充当页面的过滤器，使用 wxs 标签，类似 script 脚本，必须提供 module 属性,通过属性名调用</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;{{m1.toUpper(username)}}&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">wxs</span><span style="color:#6F42C1;"> module</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;m1&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">module.exports.toUpper = function(str) {</span></span>
<span class="line"><span style="color:#24292E;">  return str.</span><span style="color:#6F42C1;">toUpperCase</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">wxs</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>还可以定义.wxs 文件创建脚本，但需要使用在 wxs 标签添加 src 属性和 module 属性，src 属性必须为相对路径</p><p><strong>注意</strong></p><p>wxs 不支持 Es6，不支持 let，const，解构赋值、展开运算符、箭头函数等高级语法，一般使用 var 定义变量，使用 function 定义函数</p><p>wxs 是过滤器，不能作为事件的回调函数，以下是<strong>错误示例</strong><code>&lt;button bindtap=&quot;m1.toUpper&quot;&gt;&lt;/button&gt;</code></p><p>wxs 不能调用小程序的 api 和 js 文件</p><h3 id="自定义组件" tabindex="-1">自定义组件 <a class="header-anchor" href="#自定义组件" aria-label="Permalink to &quot;自定义组件&quot;">​</a></h3><p>创建 components 文件夹存放自定义组件</p><p>组件的.js 文件中调用的是 component,页面调用的是 page</p><p>1、局部引用</p><p>在页面的.json 文件中</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">usingComponents</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#032F62;">  &#39;test&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;/components/test/test&#39;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在同一页面的.wxml 中<code>&lt;test&gt;&lt;/test&gt;</code></p><p>2、全局引用 在 app.json 中</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">usingComponents</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#032F62;">&#39;test&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;/components/test/test&#39;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在所有的页面都可以使用这个组件<code>&lt;test&gt;&lt;/test&gt;</code></p><h3 id="样式" tabindex="-1">样式 <a class="header-anchor" href="#样式" aria-label="Permalink to &quot;样式&quot;">​</a></h3><p>小程序的样式不会影响到组件的样式，包括全局的样式，组件的样式是独立的</p><p>注意：此样式只有 class 样式不会影响，id、属性等样式会有影响</p><p>组件样式隔离可以被修改，因为可能需要组件被页面控制，有以下两种方法：</p><p>1、在组件的.js 文件中声明一个 options 对象</p><p><code>options：{styleIsolation:&#39;isolated&#39;}</code></p><p>2、在.json 文件中</p><p><code>{&#39;styleIsolation&#39; : &#39;isolated&#39;}</code></p><p>styleIsolation 默认为 isolated，组件不受外部影响</p><p>styleIsolation 设置为 apply-shared 表示页面可以一下组件，但组件不影响页面</p><p>styleIsolation 设置为 shared 设置为组件和页面可以互相影响</p><h3 id="数据" tabindex="-1">数据 <a class="header-anchor" href="#数据" aria-label="Permalink to &quot;数据&quot;">​</a></h3><p>定义 component 的在 data 中</p><h3 id="方法" tabindex="-1">方法 <a class="header-anchor" href="#方法" aria-label="Permalink to &quot;方法&quot;">​</a></h3><p>定义在 component 的 methods 中</p><h3 id="属性" tabindex="-1">属性 <a class="header-anchor" href="#属性" aria-label="Permalink to &quot;属性&quot;">​</a></h3><p>properties 属性可以接收外界传递到组件中的数据,type 代表属性的数据类型，value 是它的初始值,如果没有初始值则可以简写</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">properties</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#6F42C1;">  max</span><span style="color:#24292E;">:{</span></span>
<span class="line"><span style="color:#6F42C1;">    type</span><span style="color:#24292E;">: Number,</span></span>
<span class="line"><span style="color:#6F42C1;">    value</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">10</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#6F42C1;">  max</span><span style="color:#24292E;">: Number </span><span style="color:#6A737D;">// 简化的方式</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>data 和 properties 的区别</strong></p><p>两者都是可读可写的，都可以用 this.setData 重新赋值</p><p>data 倾向于存储组件的私有数据</p><p>properties 倾向于存储外界传递的数据</p><h3 id="数据监听" tabindex="-1">数据监听 <a class="header-anchor" href="#数据监听" aria-label="Permalink to &quot;数据监听&quot;">​</a></h3><p>类似 vue 的 watch，使用 observes,数据变化就会触发改函数，同时可以监听对象中的某个属性的变化</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">observe</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#032F62;">  &#39;n1, n2&#39;</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">function</span><span style="color:#24292E;">(</span><span style="color:#E36209;">n1</span><span style="color:#24292E;">, </span><span style="color:#E36209;">n2</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#005CC5;">    this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">setDate</span><span style="color:#24292E;">({sum : n1</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">n2})</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果需要监听对象上所有属性的变化可以使用通配符<code>**</code></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">obj.</span><span style="color:#D73A49;">**</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">obj</span><span style="color:#24292E;">) {}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="插槽" tabindex="-1">插槽 <a class="header-anchor" href="#插槽" aria-label="Permalink to &quot;插槽&quot;">​</a></h3><p>一个组件默认只支持一个插槽，用于渲染不确定的内容，插槽使用<code>&lt;slot&gt;</code>标签在组件内部定义</p><p>如果想启用多个插槽，可以在组件的.js 文件进行配置，多个插槽以 name 属性区分，在页面使用 slot 属性对应 name 即可</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">options</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#6F42C1;">  multipleSlots</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="组件-1" tabindex="-1">组件 <a class="header-anchor" href="#组件-1" aria-label="Permalink to &quot;组件&quot;">​</a></h2><h3 id="生命周期-1" tabindex="-1">生命周期 <a class="header-anchor" href="#生命周期-1" aria-label="Permalink to &quot;生命周期&quot;">​</a></h3><p>created 组件刚被创建时，不能使用 setData</p><p>attached 组件被创建进入页面，可以发起请求</p><p>ready 组件被渲染完成</p><p>moved 组件被移动时</p><p>detached 组件被从页面移除时，多用于清理工作</p><p>error 组件运行出错</p><p>生命周期函数最好定义在 lifetimes 对象内</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">lifetimes</span><span style="color:#24292E;">:{</span></span>
<span class="line"><span style="color:#6F42C1;">  created</span><span style="color:#24292E;">(){}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>为方便执行某些事件，组件可以监听所在页面的生命周期函数，需要定义在<code>pageLifetimes</code>节点内</p><p>show 页面被展示</p><p>hide 页面被隐藏</p><p>resize 页面尺寸变化</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">pageLifetimes</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#6F42C1;">  show</span><span style="color:#24292E;">() {}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="组件通信" tabindex="-1">组件通信 <a class="header-anchor" href="#组件通信" aria-label="Permalink to &quot;组件通信&quot;">​</a></h3><p>1、属性绑定----用于父组件向子组件传值</p><p>在父组件中</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">son</span><span style="color:#6F42C1;"> num</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;{{num}}&quot;</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">sum</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>在子组件的 js 文件中 properties 节点即可以接收此数据</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">properties</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#6F42C1;">  count</span><span style="color:#24292E;">: num</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2、事件绑定---用于子组件向父组件传值</p><p>在父组件的.js 中先定义一个自定义方法</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">getSonValue</span><span style="color:#24292E;">(e) {</span></span>
<span class="line"><span style="color:#005CC5;">  this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">setData</span><span style="color:#24292E;">({sonValue: e.detail.value})</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在父组件的 wxml 中,bind 后的名称可以自定义</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">son</span><span style="color:#6F42C1;"> bind</span><span style="color:#24292E;">:</span><span style="color:#6F42C1;">father</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;getSonValue&quot;</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">son</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>在子组件中，使用 triggerEvent 触发 bind 的自定义名</p><p><code>this.triggerEvent(&#39;father&#39;, {value: this.properties.count})</code></p><p>3、获取子组件的实例</p><p>通过 this.selectComponent(&#39;id 或 class 选择器&#39;)此方法父组件可以访问子组件的任意数据和方法</p><p>在父组件的.wxml 中</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">son</span><span style="color:#6F42C1;"> class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sonclass&quot;</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">son</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">button</span><span style="color:#6F42C1;"> bindtap</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;getChid&quot;</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在父组件的.js 文件中</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">getChild</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#D73A49;">  const</span><span style="color:#005CC5;"> child</span><span style="color:#D73A49;"> =</span><span style="color:#005CC5;"> this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">selectComponent</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;sonclass&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">  chlid.</span><span style="color:#6F42C1;">setData</span><span style="color:#24292E;">({count: child.properties.count </span><span style="color:#D73A49;">+</span><span style="color:#005CC5;"> 1</span><span style="color:#24292E;">})</span></span>
<span class="line"><span style="color:#24292E;">  child.</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>4、behaviors</p><p>用于组件共享相同代码</p><p>每个 behaviors 中都有一组属性、数据、生命周期和方法，每个组件可以引用多个 behaviors，behavior 是之间也可以互相引用</p><p>创建 behavior.js 文件</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#005CC5;">module</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">exports</span><span style="color:#D73A49;"> =</span><span style="color:#6F42C1;"> Behavior</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  properties: {},</span></span>
<span class="line"><span style="color:#24292E;">  data: {},</span></span>
<span class="line"><span style="color:#24292E;">  method: {}</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在组件内使用 require 导入</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#005CC5;"> mybehaviors</span><span style="color:#D73A49;"> =</span><span style="color:#6F42C1;"> required</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;url&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6F42C1;">Component</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  behaviors: [mybehaviors]</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>5、全局数据共享</p><p>使用<code>mobx-miniprogram@4.13.2</code>创建 store 实例对象</p><p>使用<code>mobx-miniprogram-bindings@1.2.1</code>把 store 里面的方法共享给组件</p><p>使用时 npm 时注意先删除 minniprogram_npm 文件夹并重新构建 npm</p><p>创建 store 实例对象</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { observable, action } </span><span style="color:#D73A49;">from</span><span style="color:#032F62;"> &#39;mobx-miniprogram&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> store</span><span style="color:#D73A49;"> =</span><span style="color:#6F42C1;"> observale</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  numA: </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  numB: </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#6A737D;">  // 计算属性</span></span>
<span class="line"><span style="color:#D73A49;">  get</span><span style="color:#6F42C1;"> sum</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#D73A49;">    return</span><span style="color:#005CC5;"> this</span><span style="color:#24292E;">.numA </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> numB</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#6A737D;">// action 方法,修改 store 里面的数据</span></span>
<span class="line"><span style="color:#24292E;">  updateNumA: </span><span style="color:#6F42C1;">action</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;">(</span><span style="color:#E36209;">step</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#005CC5;">  this</span><span style="color:#24292E;">.numA </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> step</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>绑定到页面中</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { createStoreBindings } </span><span style="color:#D73A49;">from</span><span style="color:#032F62;"> &#39;mobx-mininprogram-bindings&#39;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> {store} </span><span style="color:#D73A49;">from</span><span style="color:#032F62;"> &#39;../../store/store&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">Page</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#6F42C1;">  onLoad</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">function</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#005CC5;">    this</span><span style="color:#24292E;">.storeBindings </span><span style="color:#D73A49;">=</span><span style="color:#6F42C1;"> createStoreBindings</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">, {</span></span>
<span class="line"><span style="color:#24292E;">      store,</span></span>
<span class="line"><span style="color:#24292E;">      fields: [</span><span style="color:#032F62;">&#39;numA&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;numB&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;sum&#39;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">      actions: [</span><span style="color:#032F62;">&#39;updateNumA&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    })</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#6F42C1;">  onUnload</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">function</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#005CC5;">    this</span><span style="color:#24292E;">.storeBindings .</span><span style="color:#6F42C1;">destroyStoreBindings</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 在页面中使用</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;{{numA}}+{{numB}} = {{sum}}&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">van-button</span><span style="color:#6F42C1;"> bindtap</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;btnHandler1&quot;</span><span style="color:#6F42C1;"> date-step</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;{{1}}&quot;</span><span style="color:#24292E;">&gt;numA+1&lt;/</span><span style="color:#005CC5;">van-button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">van-button</span><span style="color:#6F42C1;"> bindtap</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;btnHandler1&quot;</span><span style="color:#6F42C1;"> date-step</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;{{-1}}&quot;</span><span style="color:#24292E;">&gt;numA-1&lt;/</span><span style="color:#005CC5;">van-button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;">// 事件处理函数</span></span>
<span class="line"><span style="color:#6F42C1;">btnHandler1</span><span style="color:#24292E;">(e) {</span></span>
<span class="line"><span style="color:#005CC5;">  this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">updateNumA</span><span style="color:#24292E;">(e.target.dataset.step)</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">绑定到组件中</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { storeBindingBehavior } </span><span style="color:#D73A49;">from</span><span style="color:#032F62;"> &#39;mobx-mininprogram-bindings&#39;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> {store} </span><span style="color:#D73A49;">from</span><span style="color:#032F62;"> &#39;../../store/store&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">Component</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  behavior: [storeBindingBehavior ],</span><span style="color:#6A737D;">// 通过 storeBindingBehavior 来绑定</span></span>
<span class="line"><span style="color:#24292E;">    storeBindings: {</span></span>
<span class="line"><span style="color:#24292E;">      store,</span></span>
<span class="line"><span style="color:#24292E;">      fields: {</span></span>
<span class="line"><span style="color:#6A737D;">        //绑定字段有三种方式</span></span>
<span class="line"><span style="color:#6F42C1;">        numA</span><span style="color:#24292E;">: () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> store.numA,</span></span>
<span class="line"><span style="color:#6F42C1;">        numB</span><span style="color:#24292E;">: (</span><span style="color:#E36209;">store</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> store.numB,</span></span>
<span class="line"><span style="color:#24292E;">        sum: </span><span style="color:#032F62;">&#39;sum&#39;</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">      actions: {</span></span>
<span class="line"><span style="color:#24292E;">        updateNumA: </span><span style="color:#032F62;">&#39;updateNumA&#39;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">})</span></span>
<span class="line"><span style="color:#6A737D;">// 在组件中使用</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;{{numA}}+{{numB}} = {{sum}}&lt;/</span><span style="color:#22863A;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">van-button</span><span style="color:#6F42C1;"> bindtap</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;btnHandler1&quot;</span><span style="color:#6F42C1;"> date-step</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;{{1}}&quot;</span><span style="color:#24292E;">&gt;numA+1&lt;/</span><span style="color:#005CC5;">van-button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">van-button</span><span style="color:#6F42C1;"> bindtap</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;btnHandler1&quot;</span><span style="color:#6F42C1;"> date-step</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;{{-1}}&quot;</span><span style="color:#24292E;">&gt;numA-1&lt;/</span><span style="color:#005CC5;">van-button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 组件的方法列表</span></span>
<span class="line"><span style="color:#6F42C1;">methods</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#6F42C1;">  btnHandler1</span><span style="color:#24292E;">(e) {</span></span>
<span class="line"><span style="color:#005CC5;">    this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">updateNumA</span><span style="color:#24292E;">(e.target.dataset.step)</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="其他" tabindex="-1">其他 <a class="header-anchor" href="#其他" aria-label="Permalink to &quot;其他&quot;">​</a></h2><h3 id="分包" tabindex="-1">分包 <a class="header-anchor" href="#分包" aria-label="Permalink to &quot;分包&quot;">​</a></h3><p>优化小程序的首次启动下载时间，同时利于多人开发</p><p>分包不能超过 16M 单个分包不能超过 2M</p><p>tabBar 页面必须在主包内</p><p>在 app.json 与 pages 同级处声明一个 subpackages 节点</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#032F62;">&quot;pages&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#032F62;">  &quot;pages/home/home&quot;</span></span>
<span class="line"><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#032F62;">&quot;subpackages&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">  {</span></span>
<span class="line"><span style="color:#032F62;">    &quot;root&quot;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&quot;packageA&quot;</span><span style="color:#24292E;">,</span><span style="color:#6A737D;">// 分包的根目录</span></span>
<span class="line"><span style="color:#24292E;">    “name”: </span><span style="color:#032F62;">&quot;p1&quot;</span><span style="color:#24292E;">,</span><span style="color:#6A737D;">// 分包的别名</span></span>
<span class="line"><span style="color:#032F62;">    &quot;pages&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#032F62;">      &quot;pages/cat/cat&quot;</span></span>
<span class="line"><span style="color:#24292E;">    ]</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="预下载" tabindex="-1">预下载 <a class="header-anchor" href="#预下载" aria-label="Permalink to &quot;预下载&quot;">​</a></h3><p>分包预下载是在进入某个页面由框架将分包下载完毕</p><p>在 app.json 中使用 preloadRule 指定预下载规则</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#032F62;">&#39;preloadRule&#39;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#032F62;">  &quot;pages/contact/contact&quot;</span><span style="color:#24292E;">: {</span><span style="color:#6A737D;">// 触发分包预下载的页面路径</span></span>
<span class="line"><span style="color:#6A737D;">    // network 指网络模式，可选 wifi 和 all</span></span>
<span class="line"><span style="color:#032F62;">    &quot;network&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;all&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#6A737D;">    // 分包的 root 或 name 属性</span></span>
<span class="line"><span style="color:#032F62;">    &quot;packages&quot;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;packageA&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>同一个分包的页面享有共同预下载的大小是 2M</p><h3 id="css-变量" tabindex="-1">css 变量 <a class="header-anchor" href="#css-变量" aria-label="Permalink to &quot;css 变量&quot;">​</a></h3><p>使用 css 变量可以更加方便维护代码</p><p>先在根节点定义一个变量，这个变量将作用于这个根节点内部,变量名以--开头</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">html{</span></span>
<span class="line"><span style="color:#D73A49;">  --</span><span style="color:#24292E;">mian</span><span style="color:#D73A49;">-</span><span style="color:#6F42C1;">color</span><span style="color:#24292E;">: #fff;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在需要使用的地方使用 var 进行引用即可</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#24292E;">.box{</span></span>
<span class="line"><span style="color:#6F42C1;">  color</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">var</span><span style="color:#24292E;">(--main-color)</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>可以通过此方法对 vant 的主题样式进行自定义</p>`,349)]))}const u=n(e,[["render",o]]);export{y as __pageData,u as default};
